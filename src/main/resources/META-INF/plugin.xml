<idea-plugin>
    <id>com.devtoolkit.pro</id>
    <name>Dev Toolkit Pro</name>
    <vendor email="maoba@anybots.cloud" url="https://anybots.cloud">anybots.cloud</vendor>

    <description><![CDATA[
    Dev Toolkit Pro is a powerful IntelliJ IDEA and PyCharm plugin designed to enhance developer productivity.

    Features:
    - Global fuzzy search for RESTful URLs with keyboard shortcuts
    - Quick navigation to API endpoints
    - Git repository integration with GitHub/GitLab link copying
    - Copy Git links for current file/line with precision
    - Enhanced development workflow
    - Compatible with IntelliJ IDEA 2023.2+ and PyCharm 2023.2+
    - Support for latest IDE versions (2024.x, 2025.x)

    Framework Support:
    - IntelliJ IDEA: Spring Boot, Spring MVC, JAX-RS, FastAPI
    - PyCharm: FastAPI, Flask (coming soon)
    - Universal: Git integration, file-based endpoint scanning
    ]]></description>

    <change-notes><![CDATA[
    <h3>Version 1.0.4</h3>
    <ul>
        <li>添加"Restful Endpoints"系统搜索标签页，集成到IntelliJ IDEA的Search Everywhere对话框</li>
        <li>优化搜索体验，不再使用自定义弹窗，直接集成到系统搜索中</li>
        <li>支持模糊搜索RESTful端点，提供更直观的搜索界面</li>
        <li>添加端点图标显示，根据HTTP方法显示不同的图标</li>
        <li>保持对原有ChooseByNameContributor的支持，确保向后兼容</li>
    </ul>
    <h3>Version 1.0.3</h3>
    <ul>
        <li>修复PyCharm中的NoClassDefFoundError: com/intellij/psi/PsiJavaFile错误</li>
        <li>添加Java模块运行时检测，确保在PyCharm中无Java支持时也能正常工作</li>
        <li>优化IDE环境检测和兼容性处理，提升跨IDE稳定性</li>
        <li>使用反射机制访问Java PSI类，避免硬依赖导致的加载错误</li>
        <li>完善错误处理机制，提升插件鲁棒性</li>
    </ul>
    <h3>Version 1.0.2</h3>
    <ul>
        <li>升级支持IntelliJ IDEA 2024.3和PyCharm 2024.3</li>
        <li>修复RESTful API检索功能在最新版本中不可见的问题</li>
        <li>修复Git链接复制功能在编辑器右键菜单中不显示的问题</li>
        <li>增强FastAPI端点扫描在PyCharm中的兼容性</li>
        <li>优化系统搜索集成，提升端点显示的稳定性</li>
    </ul>
    <h3>Version 1.0.1</h3>
    <ul>
        <li>Updated compatibility for IntelliJ IDEA 2024.x and 2025.x</li>
        <li>Added support for PyCharm 2024.x and 2025.x</li>
        <li>Enhanced plugin stability with latest IDE versions</li>
        <li>Modern development environment support with asdf and justfile</li>
    </ul>
    <h3>Version 1.0.0</h3>
    <ul>
        <li>Initial release</li>
        <li>Global fuzzy search for RESTful URLs</li>
        <li>Keyboard shortcut support</li>
        <li>Git repository integration</li>
        <li>GitHub/GitLab link copying from editor</li>
        <li>Line-precise Git link generation</li>
    </ul>
    ]]></change-notes>

    <!-- Product and plugin compatibility requirements -->
    <depends>com.intellij.modules.platform</depends>
    <depends optional="true" config-file="java-features.xml">com.intellij.modules.java</depends>
    <depends optional="true">com.intellij.modules.python</depends>
    <depends optional="true">org.jetbrains.kotlin</depends>
    <depends>Git4Idea</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- RESTful Endpoints Contributor for Choose by Name dialog -->
        <chooseByNameContributor implementation="com.devtoolkit.pro.contributors.RestfulEndpointChooseByNameContributor"/>

        <!-- RESTful Endpoints Contributor for Search Everywhere dialog -->
        <searchEverywhereContributor id="DevToolkitPro.RestfulEndpoints" implementation="com.devtoolkit.pro.contributors.RestfulEndpointSearchEverywhereContributor$Factory"/>

        <!-- RESTful Endpoints Contributor for Symbols tab -->
        <gotoSymbolContributor implementation="com.devtoolkit.pro.contributors.RestfulEndpointSymbolContributor"/>

        <!-- Inlay Hints Provider for RESTful URL copying - using traditional approach -->
        <codeInsight.inlayProvider language="JAVA" implementationClass="com.devtoolkit.pro.inlay.RestfulUrlInlayHintsProvider"/>
        <codeInsight.inlayProvider language="kotlin" implementationClass="com.devtoolkit.pro.inlay.RestfulUrlInlayHintsProvider"/>

        <!-- Line Marker Provider for RESTful URL copying with Gutter Icons -->
        <codeInsight.lineMarkerProvider language="JAVA" implementationClass="com.devtoolkit.pro.inlay.RestfulUrlLineMarkerProvider"/>
        <codeInsight.lineMarkerProvider language="kotlin" implementationClass="com.devtoolkit.pro.inlay.RestfulUrlLineMarkerProvider"/>

        <!-- Inlay Action Handler for URL copying -->
        <codeInsight.inlayActionHandler id="copy.url.action" implementationClass="com.devtoolkit.pro.inlay.CopyUrlActionHandler"/>

        <!-- Notification Group for RestfulTool -->
        <notificationGroup id="RestfulTool" displayType="BALLOON" key="notification.group.restfultool"/>
    </extensions>

    <actions>
        <!-- Global RESTful URL Search Action -->
        <action id="DevToolkitPro.SearchRestfulUrls"
                class="com.devtoolkit.pro.actions.SearchRestfulUrlsAction"
                text="Search RESTful URLs"
                description="Global fuzzy search for RESTful URLs">
            <keyboard-shortcut keymap="$default" first-keystroke="control shift R"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta shift R"/>
            <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta shift R"/>
        </action>

        <!-- Direct Search Everywhere Action for Restful Endpoints -->
        <action id="DevToolkitPro.SearchRestfulEndpointsEverywhere"
                class="com.devtoolkit.pro.actions.SearchRestfulEndpointsEverywhereAction"
                text="Search Restful Endpoints"
                description="Open Search Everywhere with Restful Endpoints tab">
            <keyboard-shortcut keymap="$default" first-keystroke="control alt R"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta alt R"/>
            <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta alt R"/>
            <!-- Command + \ shortcut for Mac -->
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta BACK_SLASH"/>
            <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta BACK_SLASH"/>
        </action>

        <!-- Copy Editor Git Link Action -->
        <action id="DevToolkitPro.CopyEditorGitLink"
                class="com.devtoolkit.pro.actions.CopyEditorGitLinkAction"
                text="Copy Git Link"
                description="Copy GitHub/GitLab link for current file/line">
            <!-- 编辑器中的Git链接复制功能 -->
        </action>

        <!-- Add action to Tools menu -->
        <group id="DevToolkitPro.ToolsMenu" text="Dev Toolkit Pro" description="Dev Toolkit Pro actions">
            <add-to-group group-id="ToolsMenu" anchor="first"/>
            <reference ref="DevToolkitPro.SearchRestfulUrls"/>
            <reference ref="DevToolkitPro.SearchRestfulEndpointsEverywhere"/>
        </group>

        <!-- Add Git link action to editor context menu -->
        <group id="DevToolkitPro.EditorContextMenu" text="Dev Toolkit Pro">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <reference ref="DevToolkitPro.CopyEditorGitLink"/>
        </group>
    </actions>
</idea-plugin>